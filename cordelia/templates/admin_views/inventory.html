{% extends "base.html" %}

{% block content %}

<style>
  table {
    background: linear-gradient(135deg, #817467 0%, #3d3d3d 100%);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
  }
  .btn-smaller {
    padding: 0.08rem 0.15rem;
    font-size: 0.7rem;
  }
  .custom-btn {
    position: relative;
  }
  .arrow-down {
    border: solid #ffffff;
    border-width: 0 3px 3px 0;
    display: inline-block;
    padding: 2px;
    transform: rotate(45deg);
    -webkit-transform: rotate(45deg);
  }
  /* Custom CSS for reducing space between text and arrow button */
  .text-arrow-container {
    display: flex;
    align-items: center;
  }

  .text-arrow-container .text-left {
    margin-right: 5px; 
  }
  .custom-form-control {
    padding: 0.25rem 0.5rem; 
    font-size: 0.7rem; 
  }
  .custom-footer::before {
    content: ""; /* Empty content */
    display: block;
    height: 20px; 
  }
  .pagination-container {
    position: absolute;
    margin: auto;
    padding-left: 68px;
    padding-top: 15px;
  }
  .content-container {
    background-color: #ad967e; /* Darker variation of #DCC6B6 */
    border-radius: 8px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Subtle box shadow for depth */
    padding: 4px;
  }
</style>


<div class="d-flex justify-content-center" style="background-color: #b8a495dc; padding-top: 10px; padding-bottom: 10px;">
  <div class="col-md-2 d-flex flex-column">
    <div class="row pl-3"> 
      <table class="table table-dark flex-1 p-1">
        <thead>
          <tr>
            <th>
              <span class="text-left text-light" style="font-size: 12px;">Database</span>
            </th>
            <th>
              <button type="submit" class="btn btn-outline-light btn-smaller mr-2 btn-dark">
                <a href="{{ url_for('admin.downloadExcell') }}" class="text-light">Download</a>
              </button>
            </th>            
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <a href="{{ url_for('admin.inventory') }}" class="text-left text-light" style="font-size: 12px;">Dress     .</a> <span class="badge badge-light">{{ inventory.total }}</span>
            </td>
          </tr>
          <tr>
            <td>
              <a href="{{ url_for('admin.rentInventory') }}" class="text-left text-light" style="font-size: 12px;">Rent</a>
            </td>            
          </tr>
          <tr>
            <td>
              <a href="{{ url_for('admin.userInventory') }}" class="text-left text-light" style="font-size: 12px;">User</a>
            </td>
          </tr>
        </tbody>
        <tfoot class="custom-footer">
          <tr>
            <td colspan="2">
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>  

  <div class="col-md-10 ml-auto">
    <div class="d-flex justify-content-center">
      <table class="table table-sm table-dark" style="width: 100%;"> 
        <thead>
          <tr>
            <th colspan="2" style="width: 100%; position: relative;">
              <div class="d-flex justify-content-between align-items-center">
                <span class="text-left text-light" style="font-size: 14px;">
                  <span style="margin-right: 1rem;">Dress</span>
                </span>
                <div class="pagination-container">
                {% if inventory.has_prev or inventory.has_next %}
                  <nav aria-label="Inventory pagination">
                    <ul class="pagination justify-content-center">
                      {% if inventory.has_prev %}
                      <li class="page-item">
                        <a class="btn btn-outline-light btn-sm btn-smaller btn-dark" href="{{ url_for('admin.inventory', page=inventory.prev_num) }}" aria-label="Previous">prev</a>
                      </li>
                      {% endif %}
                    
                      {% for page_num in inventory.iter_pages(left_edge=1, left_current=1, right_current=1, right_edge=1) %}
                      {% if page_num %}
                      <li class="page-item {% if page_num == inventory.page %}active{% endif %}">
                        <a class="btn btn-outline-light btn-sm btn-smaller btn-dark" href="{{ url_for('admin.inventory', page=page_num) }}">{{ page_num }}</a>
                      </li>
                      {% else %}
                      <li class="page-item disabled"><span class="page-link">&hellip;</span></li>
                      {% endif %}
                      {% endfor %}
                    
                      {% if inventory.has_next %}
                      <li class="page-item">
                        <a class="btn btn-outline-light btn-sm btn-smaller btn-dark" href="{{ url_for('admin.inventory', page=inventory.next_num) }}" aria-label="Next">next</a>
                      </li>
                      {% endif %}
                    </ul>
                  </nav>
                  {% endif %}
                </div>
                <div class="ml-auto" style="padding-bottom: 2px;">
                  <a href="{{ url_for('admin.update', title='Add Dress', form_type='dress') }}" class="btn btn-outline-light btn-smaller mr-2 btn-dark">
                      Add Dress
                  </a>
                </div>              
                <form method="POST" action="{{ url_for('admin.inventory') }}" class="form-inline">
                  {{ form.hidden_tag() }}
                  <div class="form-group" style="padding-right: 2.5px;">
                    {{ form.category(class="form-control form-control-sm custom-form-control mr-2", id="category-input", style="width: 12em;", style="background-color: #333; color: #fff;") }}
                    {{ form.search(class="form-control form-control-sm custom-form-control mr-2", type="search", placeholder="Search", style="background-color: #333; color: #fff;") }}
                    <button type="submit" class="btn btn-outline-light btn-smaller btn-dark">Filter</button>
                  </div>
                </form> 
              </div>
            </th>
          </tr>
        </thead>        
        <tbody>
          {% for dress in inventory.items %}
          <tr>
            <td colspan="2">
              <div class="accordion" id="accordion{{ loop.index }}">
                <div class="card bg-dark">
                  <div class="card-header" id="heading{{ loop.index }}">
                    <h6 class="mb-0">
                      <div class="row align-items-center">
                        <!-- First column, left part of the card -->
                        <div class="col-md-4">
                          <div class="d-flex justify-content-start">
                            <button class="btn btn-sm" type="button" data-toggle="collapse" data-target="#collapse{{ loop.index }}" aria-expanded="true" aria-controls="collapse{{ loop.index }}">
                              <span class="arrow-down"></span>
                            </button>
                            <div class="text-arrow-container ml-2">
                              <span class="text-left text-light" style="font-size: 13px;">{{ dress }}</span>
                            </div>
                          </div>
                        </div>
                      
                        <!-- Second column, middle part of the card -->
                        <div class="col-md-4">
                          <div class="d-flex justify-content-start">
                            <div class="text-arrow-container">
                              <span class="text-left text-light" style="font-size: 13px;">Brand  |  | {{ dress.brand }}</span>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-1 d-flex justify-content-center">
                          {% if not dress.maintenanceStatus %}
                            <form method="POST" action="{{ url_for('admin.update_maintenance', dress_id=dress.id) }}" class="form-inline">
                              {{ maintenance_form.csrf_token }}
                              {{ maintenance_form.dress_id(value=dress.id) }}
                              <!-- Button with the hover effect using inline CSS -->
                              <button type="submit" class="badge badge-pill badge-dark badge-small text-light"
                              style="background-color: #34c4b0; border: none; padding: 2px 5px; border-radius: 20px; cursor: pointer;"
                              onmouseover="this.style.backgroundColor='#138496';"
                              onmouseout="this.style.backgroundColor='#34c4b0';"
                              >
                              <span class="text text-dark" style="font-size: 11px;">clean</span>
                              </button>
                            </form>
                          {% else %}
                            <form method="POST" action="{{ url_for('admin.update_maintenance', dress_id=dress.id) }}" class="form-inline">
                              {{ maintenance_form.csrf_token }}
                              {{ maintenance_form.dress_id(value=dress.id) }}
                              <!-- Button with the hover effect using inline CSS -->
                              <button type="submit" class="badge badge-pill badge-warning badge-small text-dark"
                              style="background-color: #ffc107; border: none; padding: 2px 5px; border-radius: 20px; cursor: pointer;"
                              onmouseover="this.style.backgroundColor='#ffa000';"
                              onmouseout="this.style.backgroundColor='#ffc107';"
                              >
                              <span style="font-size: 11px;">end</span>
                              </button>
                            </form>
                          {% endif %}
                        </div>                        
                      
                        <!-- Third column, sellable badge -->
                        <div class="col-md-1 d-flex justify-content-center">
                          {% if dress.sellable %}
                            <span class="badge badge-pill badge-dark badge-small" style="font-size: 12px;">sellable</span>
                          {% else %}
                            <span class="text text-dark" style="font-size: 12px;">{{ dress.sellable }}</span>
                          {% endif %}
                        </div>

                        <div class="col-md-1 d-flex justify-content-center">
                          {% if not dress.rentStatus %}
                            {% if not dress.maintenanceStatus %}
                              <span class="badge badge-pill badge-success badge-small text-light" style="font-size: 11px;">stock</span>
                            {% else %}
                              <span class="badge badge-pill badge-warning badge-small btn-sm" style="font-size: 11px;">@clean</span>
                            {% endif %}
                          {% else %}
                            <span class="badge badge-pill badge-secondary badge-small text-light" style="font-size: 11px;">rented</span>
                          {% endif %}
                        </div>
                      
                        <!-- Fourth column, availability badge -->
                        <div class="col-md-1 d-flex justify-content-end">
                          {% if not dress.rentStatus and not dress.maintenanceStatus %}
                          <form method="POST" action="{{ url_for('admin.delete_object', dataBase='Dress', id=dress.id) }}" class="form-inline" onsubmit="return confirm('Are you sure you want to delete this dress? This action cannot be undone.');">
                            {{ delete_form.hidden_tag() }}
                            <input type="hidden" name="dataBase" value="Dress">
                            <input type="hidden" name="id" value="{{ dress.id }}">
                            <!-- Use the Bootstrap close button here -->
                            <button type="submit" class="btn btn-dark btn-sm btn-smaller text-light" aria-label="Close">
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </form>
                          {% else %}
                          <form method="POST" action="{{ url_for('admin.delete_object', dataBase='Dress', id=dress.id) }}" class="form-inline" onsubmit="return false;">
                            {{ delete_form.hidden_tag() }}
                            <input type="hidden" name="dataBase" value="Dress">
                            <input type="hidden" name="id" value="{{ dress.id }}">
                            <!-- Use the Bootstrap close button here -->
                            <button type="submit" class="btn btn-dark btn-sm btn-smaller text-light" aria-label="Close" disabled>
                              <span aria-hidden="true">&times;</span>
                            </button>
                          </form>
                          {% endif %}
                        </div>                                            
                      </div>
                    </h6>
                  </div>
                </div>
              </div>
              <div>
                <div id="collapse{{ loop.index }}" class="collapse" aria-labelledby="heading{{ loop.index }}" data-parent="#accordion{{ loop.index }}">
                  <div class="card-body">
                    <table class="table table-striped table-hover table-sm table-dark">
                      <tbody style="font-size: 15px;">
                        <tr>
                          <td style="width: 65%; vertical-align: middle; padding-left: 10px;">
                            <!-- Inner table with the content of the rows -->
                            <table style="width: 65%;">
                              <tbody>
                                <!-- Rows with the content of the main table -->
                                <tr>
                                  <th scope="row">Rent for:</th>
                                  <td>{{ dress.rentPrice }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Size:</th>
                                  <td>{{ dress.size }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Color:</th>
                                  <td>{{ dress.color }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Style:</th>
                                  <td>{{ dress.style }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Dress Cost:</th>
                                  <td>{{ dress.dressCost }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Market Price:</th>
                                  <td>{{ dress.marketPrice }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Rents to return Investment:</th>
                                  <td>{{ dress.rentsToReturnInvestment }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">Times Rented:</th>
                                  <td>{{ dress.timesRented }}</td>
                                </tr>
                                <tr>
                                  <th scope="row">In maintenance:</th>
                                  <td>{{ dress.maintenanceStatus }}</td>
                                </tr>
                              </tbody>
                            </table>
                          </td>
                          <td style="text-align: center; vertical-align: middle; padding-right: 52px; padding-top: 16px; padding-bottom: 16px;">
                            <!-- Image -->
                            <img src="{{ url_for('static', filename='images/cordelia-logo.png') }}" alt="..." class="img-thumbnail" style="width: 100%; height: auto;">
                          </td>                               
                        </tr>
                      </tbody>
                    </table>                                     
                  </div>
                </div>
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
        <tfoot class="custom-footer">
          <tr>
            <td colspan="2">
            </td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>

{% endblock %}